## 背景与目标

当前仓库在 `ui/web` 与 `ui/desktop` 下各自独立维护一套 Vite + React 工程，导致：
- 依赖与版本漂移（React/Vite/ESLint/TS 不一致）
- 配置与样板文件重复
- 阅读路径不清晰，影响“上下文记忆”

本次包含两项任务：
1) 将 web 与 desktop 做成“共用化/工作区化”，尽量减少重复文件与重复配置，保持代码精简易读，并生成可复用的依赖锁定文件。
2) 优化桌宠交互与按钮动效：角色悬停停止移动并抖动；按钮默认静态、悬停旋转；图标悬停为手型；同时继续保证透明置顶与默认鼠标穿透。

所有新增/更新文档使用中文。

---

## 任务 1：共用化（Workspaces）与目录整理

### 方案选择

采用 **npm workspaces**（不引入新包管理器），在仓库根目录新增 `package.json`，将以下项目纳入工作区：
- `ui/web`
- `ui/desktop`
- （新增）`ui/shared`（用于共享类型/常量/协议，避免复制粘贴）

核心目标是“统一入口、统一锁文件、降低重复与漂移”，并保持迁移改动尽量小（优先不做大规模移动目录）。

### 实施步骤

1. 在仓库根目录新增 `package.json`：
   - `private: true`
   - `workspaces: ["ui/web", "ui/desktop", "ui/shared"]`
   - 增加根脚本（示例）：
     - `dev:web`：运行 web dev
     - `dev:desktop`：运行 desktop dev
     - `install:ui`：统一安装（在根目录执行一次，生成根 `package-lock.json`）
   - 脚本优先使用 `npm -w <workspace> run <script>`，避免额外引入并发工具依赖。

2. 新增 `ui/shared` 工作区包（最小化）：
   - 仅包含 `package.json` + `src/index.ts` + `tsconfig.json`（如有必要）
   - 先抽取“桌宠 IPC 协议类型（MenuResult、mouseInteractive 等）”到 shared，desktop 引用，避免散落在 preload / renderer。
   - web 暂时可不引用（未来做控制台时再接入），但协议由 shared 统一维护。

3. 减少重复与杂乱（以“不影响功能”为前提）：
   - 清理模板残留（如未使用的示例组件/样式文件/默认文档内容），保留必要配置。
   - 统一 README 信息与入口命令，明确：
     - 根目录如何安装/启动
     - web 与 desktop 的定位
     - desktop 的主进程/预加载/渲染层结构

4. 生成/更新依赖锁定文件：
   - 在根目录执行一次 `npm install` 以生成根 `package-lock.json`。
   - 保留或清理子项目 `package-lock.json` 的策略：
     - 优先保留根锁文件作为唯一来源（后续根据实际 npm 行为决定是否删除子锁文件，以避免冲突）。

### 验证点

- 根目录执行安装后，`npm -w ui/web run dev` 与 `npm -w ui/desktop run dev` 均可正常启动。
- 依赖锁定文件可在新环境直接复现安装结果。
- 代码结构更清晰：共享协议在 `ui/shared`，桌宠入口清晰可追踪。

---

## 任务 2：桌宠交互与按钮动效

### 角色悬停：停止移动 + 抖动动效

1. 在 Phaser 场景中让角色可交互：
   - `setInteractive()` 并监听 `pointerover` / `pointerout`。
2. `pointerover` 行为：
   - 停止左右移动 tween。
   - 启动“抖动”动效（例如短周期的 `x` 微幅抖动 + `rotation` 轻微摆动，或 `y` 轻微上下抖动），保证观感自然。
3. `pointerout` 行为：
   - 停止抖动 tween。
   - 恢复左右移动 tween，并保持贴底与方向翻转逻辑。

说明：当前主进程使用 `setIgnoreMouseEvents(true, { forward: true })`，可让渲染层收到鼠标移动事件，用于悬停检测；点击仍默认穿透，符合“默认鼠标可穿透”的要求。

### IPC 按钮：默认静态，悬停旋转，光标手型

1. 默认展示静态图标 `public/electron-vite.svg`。
2. 鼠标移入按钮区域：
   - 图标切换为 `public/electron-vite.animate.svg`（旋转动画）。
   - 同时通过 IPC 切换主窗口为可交互，确保按钮可点击。
3. 鼠标移出按钮区域：
   - 图标切回静态。
   - 恢复窗口鼠标穿透。
4. 样式补充：
   - 图标/按钮区域设置 `cursor: pointer`（手型）。

### 验证点

- 鼠标移到角色上：角色停止走动并开始抖动；移开后继续走动。
- 鼠标移到按钮：图标旋转并显示手型；点击可打开 IPC 菜单；移开恢复静态与穿透。
- 整体窗口仍透明置顶，默认鼠标可穿透，不影响底层应用交互。

---

## 文档更新（中文）

需要更新以下文档为中文并对齐当前实现：
- `ui/web/README.md`
- `ui/desktop/README.md`

内容包括：
- 项目定位与结构说明
- 根目录 workspaces 的安装/启动方式
- desktop 的关键能力（透明置顶、穿透、IPC、Phaser 桌宠）

